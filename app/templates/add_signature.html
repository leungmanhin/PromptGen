{% extends 'base.html' %}

{% block title %}Add New Signature{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>Add New Signature</h1>
    
    {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
    {% endif %}
    
    <div class="card">
        <div class="card-body">
            <form method="post">
                <div class="mb-3">
                    <label for="name" class="form-label">Name <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="name" name="name" required 
                           placeholder="Enter signature class name (e.g., MyTask)"
                           value="{{ signature.name if signature else '' }}">
                    <div class="form-text">The name of the signature class (e.g., PLNTask).</div>
                </div>
                
                <div class="mb-3">
                    <label for="description" class="form-label">Description <span class="text-danger">*</span></label>
                    <textarea class="form-control" id="description" name="description" rows="2" required
                              placeholder="Enter a short description of what this signature does">{{ signature.description if signature else '' }}</textarea>
                </div>
                
                <div class="mb-3">
                    <label for="input_fields" class="form-label">Input Fields <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="input_fields" name="input_fields" required
                           placeholder="Comma-separated list of input fields (e.g., english, context)"
                           value="{{ signature.input_fields|join(', ') if signature and signature.input_fields else '' }}">
                    <div class="form-text">Comma-separated list of input field names.</div>
                </div>
                
                <div class="mb-3">
                    <label for="output_fields" class="form-label">Output Fields <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="output_fields" name="output_fields" required
                           placeholder="Comma-separated list of output fields (e.g., pln_types, pln_statements, pln_query)"
                           value="{{ signature.output_fields|join(', ') if signature and signature.output_fields else '' }}">
                    <div class="form-text">Comma-separated list of output field names.</div>
                </div>
                
                <div class="mb-3">
                    <label for="signature_class_def" class="form-label">Class Definition <span class="text-danger">*</span></label>
                    <textarea class="form-control" id="signature_class_def" name="signature_class_def" rows="15" required
                              placeholder="class MyTask(dspy.Signature):
    """
    Description of the task.
    """
    input_field = dspy.InputField(desc="Description of input field")
    output_field = dspy.OutputField(desc="Description of output field")
">{{ signature.signature_class_def if signature else '' }}</textarea>
                    <div class="form-text">The complete DSPy signature class definition.</div>
                </div>
                
                <div class="d-flex justify-content-between">
                    <a href="{{ url_for('signatures.view_signatures') }}" class="btn btn-secondary">Cancel</a>
                    <button type="submit" class="btn btn-primary">Save Signature</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}